<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Strict//EN'
   'http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd'>
  <html xmlns='http://www.w3.org/1999/xhtml'>
    <head>
      <meta http-equiv='content-type' content='text/html; charset=utf-8' />
      <meta name='generator' content='CoverStory' />
      <link rel=StyleSheet href='coverstory.css' type='text/css'>
      <script src='coverstory.js' language='javascript' type='text/javascript'></script>
      <title>MiscMergeEngine.m</title>
    </head>
    <body id='coverstory' onload='coverstory_load()' onunload='coverstory_unload()'>
      <div id='maincontainer'>
        <h1 id='sourcename'>MiscMergeEngine.m</h1>
        <h2 id='sourcepath'>/Volumes/Data/Development/GitHub/MiscMerge/MiscMerge/MiscMergeEngine.m</h2>
        <div id='sourcedate'>2/6/2014, 9:29 PM</div>
        <div id='filelistcontainer'>
          <div id='filesummary'>48.8% of 2267 lines</div>
          <table id='filetable'>
            <tr id='filelistheader'>
              <th id='filelistheadersource'>Source</th>
              <th id='filelistheaderpercent'>%</th>
            </tr>
            <tr class='fileline'>
<td class='filename'><a href='_MiscMergeDelayedParseCommand.h.html'>_MiscMergeDelayedParseCommand.h</a></td>
<td class='filepercent'><span class='filelessthan25percent'>0.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeDelayedParseCommand.m.html'>_MiscMergeDelayedParseCommand.m</a></td>
<td class='filepercent'><span class='filelessthan25percent'>0.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeIncludeCommand.h.html'>_MiscMergeIncludeCommand.h</a></td>
<td class='filepercent'><span class='filelessthan25percent'>0.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeOptionCommand.h.html'>_MiscMergeOptionCommand.h</a></td>
<td class='filepercent'><span class='filelessthan25percent'>0.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeOptionCommand.m.html'>_MiscMergeOptionCommand.m</a></td>
<td class='filepercent'><span class='filelessthan25percent'>16.25</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeProcedureCommand.m.html'>_MiscMergeProcedureCommand.m</a></td>
<td class='filepercent'><span class='filelessthan25percent'>24.74</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeForeachCommand.m.html'>_MiscMergeForeachCommand.m</a></td>
<td class='filepercent'><span class='filelessthan35percent'>25.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeExpression.m.html'>MiscMergeExpression.m</a></td>
<td class='filepercent'><span class='filelessthan35percent'>27.56</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeSetCommand.m.html'>_MiscMergeSetCommand.m</a></td>
<td class='filepercent'><span class='filelessthan35percent'>28.21</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeLoopCommand.m.html'>_MiscMergeLoopCommand.m</a></td>
<td class='filepercent'><span class='filelessthan35percent'>29.82</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeIndexCommand.m.html'>_MiscMergeIndexCommand.m</a></td>
<td class='filepercent'><span class='filelessthan45percent'>38.89</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='NSString+MiscAdditions.m.html'>NSString+MiscAdditions.m</a></td>
<td class='filepercent'><span class='filelessthan45percent'>42.13</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeElseifCommand.m.html'>_MiscMergeElseifCommand.m</a></td>
<td class='filepercent'><span class='filelessthan45percent'>42.86</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeNextCommand.m.html'>_MiscMergeNextCommand.m</a></td>
<td class='filepercent'><span class='filelessthan45percent'>42.86</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeOmitCommand.m.html'>_MiscMergeOmitCommand.m</a></td>
<td class='filepercent'><span class='filelessthan45percent'>42.86</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeCallCommand.m.html'>_MiscMergeCallCommand.m</a></td>
<td class='filepercent'><span class='filelessthan45percent'>43.48</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeIncludeCommand.m.html'>_MiscMergeIncludeCommand.m</a></td>
<td class='filepercent'><span class='filelessthan45percent'>43.48</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeFunctions.m.html'>MiscMergeFunctions.m</a></td>
<td class='filepercent'><span class='filelessthan55percent'>45.68</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeDebugCommand.m.html'>_MiscMergeDebugCommand.m</a></td>
<td class='filepercent'><span class='filelessthan55percent'>46.15</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeEngine.m.html'>MiscMergeEngine.m</a></td>
<td class='filepercent'><span class='filelessthan55percent'>49.80</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeContinueCommand.m.html'>_MiscMergeContinueCommand.m</a></td>
<td class='filepercent'><span class='filelessthan55percent'>50.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeDateCommand.m.html'>_MiscMergeDateCommand.m</a></td>
<td class='filepercent'><span class='filelessthan55percent'>50.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeCommand.m.html'>MiscMergeCommand.m</a></td>
<td class='filepercent'><span class='filelessthan55percent'>53.16</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeWhileCommand.m.html'>_MiscMergeWhileCommand.m</a></td>
<td class='filepercent'><span class='filelessthan55percent'>54.17</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeEngine.h.html'>MiscMergeEngine.h</a></td>
<td class='filepercent'><span class='filelessthan65percent'>55.56</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeBreakCommand.m.html'>_MiscMergeBreakCommand.m</a></td>
<td class='filepercent'><span class='filelessthan65percent'>63.64</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='NSScanner+MiscMerge.m.html'>NSScanner+MiscMerge.m</a></td>
<td class='filepercent'><span class='filelessthan75percent'>66.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeForeachCommand.h.html'>_MiscMergeForeachCommand.h</a></td>
<td class='filepercent'><span class='filelessthan75percent'>66.67</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeIndexCommand.h.html'>_MiscMergeIndexCommand.h</a></td>
<td class='filepercent'><span class='filelessthan75percent'>66.67</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeDriver.m.html'>MiscMergeDriver.m</a></td>
<td class='filepercent'><span class='filelessthan75percent'>69.49</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeTemplate.m.html'>MiscMergeTemplate.m</a></td>
<td class='filepercent'><span class='filelessthan75percent'>72.53</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeCallCommand.h.html'>_MiscMergeCallCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>75.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeEndforeachCommand.m.html'>_MiscMergeEndforeachCommand.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>83.33</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeEndloopCommand.m.html'>_MiscMergeEndloopCommand.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>83.33</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeEndprocedureCommand.m.html'>_MiscMergeEndprocedureCommand.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>83.33</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeTemplate.h.html'>MiscMergeTemplate.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>83.33</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeCommentCommand.m.html'>_MiscMergeCommentCommand.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>87.50</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeEndwhileCommand.m.html'>_MiscMergeEndwhileCommand.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>88.89</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeCopyCommand.m.html'>_MiscMergeCopyCommand.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>92.86</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeIfCommand.m.html'>_MiscMergeIfCommand.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>93.94</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='KeyValue+MiscMerge.m.html'>KeyValue+MiscMerge.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='NSCharacterSet+MiscMerge.m.html'>NSCharacterSet+MiscMerge.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeCopyCommand.h.html'>_MiscMergeCopyCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeDateCommand.h.html'>_MiscMergeDateCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeDebugCommand.h.html'>_MiscMergeDebugCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeElseCommand.m.html'>_MiscMergeElseCommand.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeEndforeachCommand.h.html'>_MiscMergeEndforeachCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeEndifCommand.m.html'>_MiscMergeEndifCommand.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeEndloopCommand.h.html'>_MiscMergeEndloopCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeEndprocedureCommand.h.html'>_MiscMergeEndprocedureCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeFieldCommand.h.html'>_MiscMergeFieldCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeFieldCommand.m.html'>_MiscMergeFieldCommand.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeIdentifyCommand.m.html'>_MiscMergeIdentifyCommand.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeIfCommand.h.html'>_MiscMergeIfCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeLoopCommand.h.html'>_MiscMergeLoopCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeProcedureCommand.h.html'>_MiscMergeProcedureCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeSetCommand.h.html'>_MiscMergeSetCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='_MiscMergeWhileCommand.h.html'>_MiscMergeWhileCommand.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeCommandBlock.h.html'>MiscMergeCommandBlock.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeCommandBlock.m.html'>MiscMergeCommandBlock.m</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeDriver.h.html'>MiscMergeDriver.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>
<tr class='fileline'>
<td class='filename'><a href='MiscMergeMacros.h.html'>MiscMergeMacros.h</a></td>
<td class='filepercent'><span class='filegoodcoveragepercent'>100.00</span></td>
</tr>

          </table>
        </div>
        <div id='sourcecontainer'>
          <div id='sourcesummary'>Executed 49.8% of 245 lines (122 executed, 245 executable, 604 total lines)</div>
          <table id='sourcetable'>
          <tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//  MiscMergeEngine.m</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//  Written by Don Yacktman and Carl Lindberg</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//  Copyright 2001-2004 by Don Yacktman and Carl Lindberg.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//  All rights reserved.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//      This notice may not be removed from this source code.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//  This header is included in the MiscKit by permission from the author</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//  and its use is governed by the MiscKit license, found in the file</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//  &quot;License.rtf&quot; in the MiscKit distribution.  Please refer to that file</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//  for a list of all applicable permissions and restrictions.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>//</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>#import &quot;MiscMergeEngine.h&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>#import &lt;Foundation/NSString.h&gt;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>#import &lt;Foundation/NSDictionary.h&gt;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>#import &lt;Foundation/NSArray.h&gt;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>#import &lt;Foundation/NSAutoreleasePool.h&gt;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>#import &quot;MiscMergeTemplate.h&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>#import &quot;MiscMergeCommand.h&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>#import &quot;MiscMergeCommandBlock.h&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>#import &quot;KeyValue+MiscMerge.h&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>#import &quot;MiscMergeFunctions.h&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>#define RECURSIVE_LOOKUP_LIMIT 100</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * We can&apos;t #import a header, since we could be using either MiscKeyValue,</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * EOControl, or (on MacOS X) Foundation.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> */</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>@interface NSObject (WarningAvoidance)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>- (id)valueForKeyPath:(NSString *)keyPath;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>@end</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>@interface MiscMergeEngine ()</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>@property (strong, nonatomic, readwrite) NSMutableDictionary *userInfo;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>36</td>
<td class='sourcelinehit'>@property (strong, nonatomic) NSMutableDictionary *engineSymbols;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>73</td>
<td class='sourcelinehit'>@property (strong, nonatomic) NSMutableDictionary *mergeSymbols;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>@property (strong, nonatomic) NSMutableDictionary *localSymbols;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>2026</td>
<td class='sourcelinehit'>@property (strong, nonatomic) NSMutableArray    *contextStack;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>484</td>
<td class='sourcelinehit'>@property (strong, nonatomic) NSMutableArray    *commandStack;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>640</td>
<td class='sourcelinehit'>@property (strong, nonatomic) NSMutableString   *outputBuffer;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>16</td>
<td class='sourcelinehit'>@property (assign, nonatomic) BOOL aborted;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>16</td>
<td class='sourcelinehit'>@property (weak, nonatomic) id driver;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>@end</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>@implementation MiscMergeEngine</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * A MiscMergeEngine is the heart of the merging object suite.  It actually</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * performs the merges.  To use it, simply give it a MiscMergeTemplate that</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * has been properly set up with -#{setTemplate:}.  Next, give it a data</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * object (-#{setMainObject:}) that has values for the contents of the</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * merge fields.  Finally, send an -#{execute:} message to start things</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * off.  -#valueForKeyPath: will be called on the main object with the</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * field names in the template, and the values returned will be substituted</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * in the output. An NSString will be returned that contains the results of</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * the merge.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * The rest of the methods are an API to the internal state of the engine</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * which may be used in MiscMergeCommand subclass implementations.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * To implement MiscMergeCommands, it is important to understand some of</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * the internals of the MiscMergeEngine class.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * The main thing to know is that there is an &quot;output&quot; string that is kept</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * throughout the merge and returned at the end.  MiscMergeCommands should</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * append strings to it as necessary with the -#{appendToOutput:} method.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * The MiscMergeEngine resolves field names through a series of symbol</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * tables.  Commands can request that arguments be &quot;resolved&quot; through these</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * symbol tables with the -#{valueForField:} method. The process is to walk</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * down the context stack until an object with the desired key is found.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * The search will look first for local variables, then on the main object,</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * then in the engine variables, and finally in the global variables.  If</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * any context objects are placed on the stack by MiscMergeCommands, they</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * are searched first. If the key is not found, then the &quot;parent&quot; merge, if</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * it exists, is consulted. If the key is not found, then the key itself is</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * returned.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * If recursive lookups are turned on, the value returned by a lookup will</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * be used as a field name and the lookup repeated, causing an indirection</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * to take place (if a value is found for the new field name). This process</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * will be repeated as far as possible, so there can be multiple levels of</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * indirection.  Use the -#setUseRecursiveLookups: method to turn this</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * feature on or off.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * By doing this extensive resolution, it is possible to use</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * MiscMergeCommands to create aliases for field names.  It is also</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * possible to use the global tables to contain &quot;default&quot; values for any</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * merge fields that might turn up empty on a particular merge.  Note that</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * there are specific methods which may be used to manipulate the local,</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * engine, and global symbol tables, as well as set up the parent merge.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Another special feature of the MiscMergeEngine is that it can carry</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * internal &quot;variables&quot; in its userInfo dictionary.  A variable is some</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * object that contains state and needs to be accessible throughout a</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * merge.  This is useful for groups of MiscMergeCommands that need to pass</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * information between each other, but do not specifically know about each</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * other.  Simply manipulate the userInfo dictionary (returned by the</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * -#userInfo method) to store or retrieve information as desired.  The</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * userInfo dictionary is not consulted during symbol lookups, and is</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * cleared at the start of a new merge, so only data pertaining to a merge</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * should be stored there.  This is the preferred way for MiscMergeCommands</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * to communicate with each other.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * The current API should be adequate to perform most things a</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * MiscMergeCommand would want to do.  However, it is possible that more</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * functionality would be helpful or that some bit of information is still</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * inaccessible.  If this is the case, complain to the author (Don</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Yacktman, don@misckit.com) and he will consider enhancing the API to</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * this object as necessary.  Of course, subclasses and categories might</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * also be workable approaches to such deficiencies.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>static NSMutableDictionary *globalSymbols = nil;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Returns the static NSMutableDictionary used to store global symbols.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Global symbols are the last context searched when resolving names, and</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * are valid for every merge done in your program (i.e. the same dictionary</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * is used in all MiscMergeEngine instances).</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>+ (NSMutableDictionary *)globalSymbolsDictionary</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    static dispatch_once_t globalSymbolsDictionaryDispatch;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>9</td>
<td class='sourcelinehit'>  dispatch_once(&amp;globalSymbolsDictionaryDispatch, ^{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1</td>
<td class='sourcelinehit'>        globalSymbols = [[NSMutableDictionary alloc] init];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1</td>
<td class='sourcelinehit'>    });</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    return globalSymbols;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Sets the global symbol aKey to anObject.  A value of nil is the same as</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * removing the value.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>+ (void)setGlobalValue:(id)anObject forKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    if (anObject == nil)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        [self removeGlobalValueForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    else</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        [[self globalSymbolsDictionary] setObject:anObject forKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; Removes the global value associated with aKey. &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>+ (void)removeGlobalValueForKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [[self globalSymbolsDictionary] removeObjectForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; Returns the global value for aKey. &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>+ (id)globalValueForKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    return [globalSymbols objectForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; The designated initializer. &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>- init</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>    self = [super init];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>    if ( self != nil )</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>        [self setUserInfo:[[NSMutableDictionary alloc] init]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>        [self setEngineSymbols:[[NSMutableDictionary alloc] init]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>        [self setMergeSymbols:[[NSMutableDictionary alloc] init]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>        [self setLocalSymbols:[self mergeSymbols]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>        [self setContextStack:[[NSMutableArray alloc] init]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>        [self setCommandStack:[[NSMutableArray alloc] init]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>    }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>    return self;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>28</td>
<td class='sourcelinehit'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Initializes a new MiscMergeEngine instance, setting the current template</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * to %{aTemplate}.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1</td>
<td class='sourcelinehit'>- initWithTemplate:(MiscMergeTemplate *)aTemplate</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1</td>
<td class='sourcelinehit'>    self = [self init];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1</td>
<td class='sourcelinehit'>    if ( self != nil )</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1</td>
<td class='sourcelinehit'>        [self setMergeTemplate:aTemplate];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1</td>
<td class='sourcelinehit'>    }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1</td>
<td class='sourcelinehit'>    return self;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1</td>
<td class='sourcelinehit'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Set whether to use recursive lookups when resolving field names.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * setUseRecursiveLookup</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)setUseRecursiveLookups:(BOOL)shouldRecurse</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    _useRecursiveLookups = shouldRecurse;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [self setRecursiveLookupLimit:RECURSIVE_LOOKUP_LIMIT];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)setUseRecursiveLookups:(BOOL)shouldRecurse limit:(NSInteger)recurseLimit</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [self setUseRecursiveLookups:shouldRecurse];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [self setRecursiveLookupLimit:recurseLimit];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Returns the output string from the latest merge, the same string</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * returned by the -#execute: method.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>- (NSString *)outputString</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    return [self outputBuffer];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; An instance method convenience for +#setGlobalValue:forKey:. &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)setGlobalValue:(id)anObject forKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [[self class] setGlobalValue:anObject forKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; An instance method convenience for +#removeGlobalValueForKey:. &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)removeGlobalValueForKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [[self class] removeGlobalValueForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; An instance method convenience for +#globalValueForKey:. &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (id)globalValueForKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    return [[self class] globalValueForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Sets the engine symbol aKey to anObject.  A value of nil is the same as</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * removing the value.  The engine symbols are searched after the main</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * object but before the global symbols when resolving a name.  They remain</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * valid for every merge executed by the receiving MiscMergeEngine instance.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)setEngineValue:(id)anObject forKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    if (anObject)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        [[self engineSymbols] setObject:anObject forKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    else</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        [self removeGlobalValueForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; Removes the engine value associated with aKey &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)removeEngineValueForKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [[self engineSymbols] removeObjectForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; Returns the engine value associated with aKey &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (id)engineValueForKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    return [[self engineSymbols] objectForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Sets the merge symbol aKey to anObject.  A value of nil is the same as</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * removing the value.  The engine symbols are searched before the main</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * object when resolving a name.  Local symbols are only valid for the</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * current merge; the local symbol table is emptied before executing a</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * merge.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)setMergeValue:(id)anObject forKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    if (anObject)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        [[self mergeSymbols] setObject:anObject forKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    else</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        [self removeMergeValueForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; Removes the merge value associated with aKey &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)removeMergeValueForKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [[self mergeSymbols] removeObjectForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; Returns the merge value associated with aKey &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (id)mergeValueForKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    return [[self mergeSymbols] objectForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Sets the local symbol aKey to anObject.  A value of nil is the same as</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * removing the value.  The engine symbols are searched before the main</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * object when resolving a name.  Local symbols are only valid for the</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * current merge; the local symbol table is emptied before executing a</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * merge.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)setLocalValue:(id)anObject forKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    if (anObject)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        [[self localSymbols] setObject:anObject forKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    else</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        [self removeLocalValueForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; Removes the local value associated with aKey &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)removeLocalValueForKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [[self localSymbols] removeObjectForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; Returns the local value associated with aKey &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (id)localValueForKey:(NSString *)aKey</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    return [[self localSymbols] objectForKey:aKey];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Adds a new context for symbol lookups.  MiscMergeCommands can use this</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * to add their own contexts to define variables that last only during the</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * execution of that command.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)addContextObject:(id)anObject andSetLocalSymbols:(BOOL)flag</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [[self contextStack] addObject:anObject];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    if ( flag &amp;&amp; [anObject isKindOfClass:[NSMutableDictionary class]] )</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        [self setLocalSymbols:anObject];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)addContextObject:(id)anObject</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [self addContextObject:anObject andSetLocalSymbols:NO];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot; Removes anObject from the context stack. &quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)removeContextObject:(id)anObject</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    if (anObject &amp;&amp; anObject != [self mainObject]</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        &amp;&amp; anObject != globalSymbols</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        &amp;&amp; anObject != [self engineSymbols]</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        &amp;&amp; anObject != [self mergeSymbols])</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        // should only remove last occurrence, not all FIXME</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        [[self contextStack] removeObjectIdenticalTo:anObject];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        if ( anObject == [self localSymbols] ) {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            NSInteger i;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            [self setLocalSymbols:nil];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            for ( i = [[self contextStack] count] - 1; i &gt;= 0; i-- ) {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                id object = [[self contextStack] objectAtIndex:i];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                if ( [object isKindOfClass:[NSMutableDictionary class]] ) {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                    [self setLocalSymbols:object];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                    break;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>                }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            if ( [self localSymbols] == nil ) {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                [self setLocalSymbols:[self mergeSymbols]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Sets the main data object.  The next invocation of -#{execute:} will use</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * %{anObject} as the main data object for the merge.  Can be called during</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * a merge to change the main object.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>- (void)setMainObject:(id)anObject</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    NSUInteger oldIndex = NSNotFound;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    if (_mainObject != nil)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>7</td>
<td class='sourcelinehit'>        oldIndex = [[self contextStack] indexOfObject:_mainObject];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>7</td>
<td class='sourcelinehit'>        if (oldIndex != NSNotFound)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>7</td>
<td class='sourcelinehit'>            [[self contextStack] removeObjectAtIndex:oldIndex];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>7</td>
<td class='sourcelinehit'>    }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    /* Insert the new object; if there was no previous object put before local symbols. */</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    if (anObject != nil)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>        if (oldIndex == NSNotFound)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1</td>
<td class='sourcelinehit'>            oldIndex = [[self contextStack] indexOfObject:[self mergeSymbols]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>        if (oldIndex != NSNotFound)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>7</td>
<td class='sourcelinehit'>            [[self contextStack] insertObject:anObject atIndex:oldIndex];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    _mainObject = anObject;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>- (NSString *)execute:sender</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [self setDriver:sender];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [self setAborted:NO];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [self setOutputBuffer:[NSMutableString string]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [[self contextStack] removeAllObjects];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [[self commandStack] removeAllObjects];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [[self mergeSymbols] removeAllObjects];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [[self contextStack] addObject:[[self class] globalSymbolsDictionary]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [[self contextStack] addObject:[self engineSymbols]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    if ([self mainObject] != nil)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>        [[self contextStack] addObject:[self mainObject]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [[self contextStack] addObject:[self mergeSymbols]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [self executeCommandBlock:[[self mergeTemplate] topLevelCommandBlock]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [self setDriver:nil];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    if ([self aborted] ==  YES)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        return @&quot;&quot;;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    return [self outputString];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Initiates a merge with the current template and %{anObject}.  Returns an</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * NSString containing the output of the merge if successful and nil</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * otherwise.  The argument %{sender} should be the initiating driver.  If</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * not, some commands, such as &quot;next&quot; will not work properly.  This method</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * is just a convenience method that calls -#setMainObject: and then</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * -#execute:.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>- (NSString *)executeWithObject:(id)anObject sender:sender</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    [self setMainObject:anObject];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>    return [self execute:sender];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>8</td>
<td class='sourcelinehit'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Executes a single command.  MiscMergeCommand subclasses should always</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * call this method instead of calling -executeForMerge: on the command</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * itself if they need to execute a command.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1072</td>
<td class='sourcelinehit'>- (MiscMergeCommandExitType)executeCommand:(MiscMergeCommand *)command</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    /*</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>     * Just execute the command.  This is meant to be a hook where we can</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>     * insert other stuff to be done on each command execution, such as</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>     * logging for debug purposes.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>     */</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1072</td>
<td class='sourcelinehit'>    return [command executeForMerge:self];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1072</td>
<td class='sourcelinehit'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Executes all the commands in block.  MiscMergeCommand subclasses should</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * use this method when they need to execute a command block.  A local</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * autorelease pool is used during execution of the block.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>224</td>
<td class='sourcelinehit'>- (MiscMergeCommandExitType)executeCommandBlock:(MiscMergeCommandBlock *)block</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>224</td>
<td class='sourcelinehit'>    NSArray *commandArray = [block commandArray];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>224</td>
<td class='sourcelinehit'>    NSInteger i, count = [commandArray count];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>224</td>
<td class='sourcelinehit'>    MiscMergeCommandExitType exitCode = MiscMergeCommandExitNormal;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    /*</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>     * Maintain the execution stack.  This stack isn&apos;t being used at the</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>     * moment, but command implementations may in the future make use of it</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>     * (a break command, for example).</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>     */</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>224</td>
<td class='sourcelinehit'>    [[self commandStack] addObject:block];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>3888</td>
<td class='sourcelinehit'>    for (i=0; (exitCode == MiscMergeCommandExitNormal) &amp;&amp; (i&lt;count); i++)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1072</td>
<td class='sourcelinehit'>        exitCode = [self executeCommand:[commandArray objectAtIndex:i]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1072</td>
<td class='sourcelinehit'>    }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>224</td>
<td class='sourcelinehit'>    [[self commandStack] removeLastObject];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>224</td>
<td class='sourcelinehit'>    return exitCode;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>224</td>
<td class='sourcelinehit'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>512</td>
<td class='sourcelinehit'>- (id)valueForField:(NSString *)fieldName quoted:(NSInteger)quoted</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>512</td>
<td class='sourcelinehit'>    NSInteger  i;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>512</td>
<td class='sourcelinehit'>    id   value = nil;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>512</td>
<td class='sourcelinehit'>    id   prevValue = nil;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>512</td>
<td class='sourcelinehit'>    id   returnValue = nil;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>512</td>
<td class='sourcelinehit'>    BOOL found = NO;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>512</td>
<td class='sourcelinehit'>    BOOL prevFound = NO;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>512</td>
<td class='sourcelinehit'>    NSInteger lookupCount = 0;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>512</td>
<td class='sourcelinehit'>    if ( quoted == 1 )</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        return fieldName;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>5608</td>
<td class='sourcelinehit'>    for (i=[[self contextStack] count]; i &gt; 0 &amp;&amp; !found; i--)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1424</td>
<td class='sourcelinehit'>        id currContext = [[self contextStack] objectAtIndex:i-1];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1424</td>
<td class='sourcelinehit'>        if ([currContext mm_hasMiscMergeKeyPath:fieldName])</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>312</td>
<td class='sourcelinehit'>            value = [currContext valueForKeyPath:fieldName];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>312</td>
<td class='sourcelinehit'>            found = YES;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>312</td>
<td class='sourcelinehit'>        }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        /*</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>         * If recursive lookup is on, use the current value as a fieldName</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>         * and restart the search.  Store the last found value, so we know</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>         * which one to return.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>         */</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1736</td>
<td class='sourcelinehit'>        if (found &amp;&amp; [self useRecursiveLookups] &amp;&amp; (lookupCount &lt; [self recursiveLookupLimit]) &amp;&amp; [value isKindOfClass:[NSString class]])</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            fieldName = value;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            prevValue = value;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            prevFound = YES;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            found = NO;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            i = [[self contextStack] count];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            lookupCount++;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1424</td>
<td class='sourcelinehit'>        else if ( [self useRecursiveLookups] &amp;&amp; (lookupCount &gt;= [self recursiveLookupLimit]) )</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            NSLog(@&quot;Recursion limit %ld reached for %@.&quot;, (long)[self recursiveLookupLimit], fieldName);</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>1424</td>
<td class='sourcelinehit'>    }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>512</td>
<td class='sourcelinehit'>    if (value == [NSNull null]) value = nil;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    /* If we found it, return it. */</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>824</td>
<td class='sourcelinehit'>    if (found) returnValue = value;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    /* If the previous iteration of the recursive search found it, return it */</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>200</td>
<td class='sourcelinehit'>    else if (prevFound) returnValue = prevValue;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>712</td>
<td class='sourcelinehit'>    if ( found || prevFound ) {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>312</td>
<td class='sourcelinehit'>        if ( returnValue == nil ) {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            switch ( [self nilLookupResult] )</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>            {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>                case MiscMergeNilLookupResultKeyIfQuoted:</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                    if ( quoted == 2 )</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                        returnValue = fieldName;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                    break;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>                    </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>                case MiscMergeNilLookupResultKey:</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                    returnValue = fieldName;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                    break;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>                    </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>                case MiscMergeNilLookupResultKeyWithDelims:</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                    returnValue = [NSString stringWithFormat:@&quot;%@%@%@&quot;, [[self mergeTemplate] startDelimiter], fieldName, [[self mergeTemplate] endDelimiter]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                    break;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>                default:</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>                    break;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>            }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>312</td>
<td class='sourcelinehit'>        return returnValue;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    /* If not found, try our parent merge */</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>200</td>
<td class='sourcelinehit'>    if ([self parentMerge] != nil)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        return [[self parentMerge] valueForField:fieldName quoted:quoted];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>400</td>
<td class='sourcelinehit'>    switch ( [self failedLookupResult] )</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        case MiscMergeFailedLookupResultKeyWithDelims:</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            return [NSString stringWithFormat:@&quot;%@%@%@&quot;, [[self mergeTemplate] startDelimiter], fieldName, [[self mergeTemplate] endDelimiter]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        case MiscMergeFailedLookupResultNil:</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>            return nil;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>            </td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        case MiscMergeFailedLookupResultKeyIfNumeric:</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>200</td>
<td class='sourcelinehit'>            return MMIsObjectANumber(fieldName) ? fieldName : nil;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        case MiscMergeFailedLookupResultKey:</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>        default:</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>200</td>
<td class='sourcelinehit'>            return fieldName;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>512</td>
<td class='sourcelinehit'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (id)valueForField:(NSString *)fieldName</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    return [self valueForField:fieldName quoted:0];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>/*&quot;</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'> * Appends %{aString} to the merge output.</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>&quot;*/</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>624</td>
<td class='sourcelinehit'>- (void)appendToOutput:(NSString *)aString</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>624</td>
<td class='sourcelinehit'>    if ( aString != nil )</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>624</td>
<td class='sourcelinehit'>        [[self outputBuffer] appendString:[aString description]];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>624</td>
<td class='sourcelinehit'>    }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>624</td>
<td class='sourcelinehit'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)abortMerge</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    [self setAborted:YES];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>- (void)advanceRecord</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>{</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    id driver = [self driver];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    if ([driver respondsToSelector:@selector(advanceRecord)] == YES)</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>    {</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>        [driver advanceRecord];</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>    }</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'>0</td>
<td class='sourcelinemissed'>}</td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'></td>
</tr>
<tr class='sourceline'>
<td class='sourcelinehitcount'></td>
<td class='sourcelineskipped'>@end</td>
</tr>

          </table>
        </div>
      </div>
    </body>
  </html>